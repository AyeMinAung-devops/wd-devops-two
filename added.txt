added by collaborator

Added some features from collaborator from fea branch
